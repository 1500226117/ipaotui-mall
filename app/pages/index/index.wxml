<import src="/templates/star-rate.wxml" />
<import src="/templates/load-more.wxml" />

<!--index.wxml-->
<view class="topbar">
  <navigator url="./address?cb=callback" class="address trangle">
    <image class="address__icon" src="/images/location.png"></image>{{currentAddress ? currentAddress.title : '定位中...'}}
  </navigator>
  <view class="search">
    <icon type="search" size="20" /> 搜索
  </view>
</view>
<view class="category">
  <navigator class="category__item" url="" wx:for="{{category}}" wx:key="category_id">
    <view>
      <image src="{{item.icon}}" class="category__icon"></image>
    </view>
    {{item.title}}
  </navigator>
</view>
<view class="weui-panel weui-panel_access">
  <view class="weui-panel__bd shop__list">
    <navigator url="/pages/shop/show?id={{item.seller_id}}" wx:for="{{shopList}}" wx:key="{{seller_id}}" class="weui-media-box weui-media-box_appmsg shop__item" hover-class="weui-cell_active">
      <view class="weui-media-box__hd weui-media-box__hd_in-appmsg">
        <image class="weui-media-box__thumb" src="{{item.pic_url}}" />
      </view>
      <view class="weui-media-box__bd weui-media-box__bd_in-appmsg">
        <view class="weui-media-box__title">{{item.seller_name}}</view>
        <view class="weui-media-box__desc shop__desc">
          <view class="shop__sales">
            <view class="shop__star">
              <template is="star-rate" data="{{value: item.overall}}" />
            </view>
            <view>月售 {{item.sales}} 单</view>
          </view>

          <view class="shop__misc weui-flex">
            <view class="shop__fee weui-flex__item">
              起送 ¥{{item.min_price}}
            </view>
            <text class="shop__reach-time grey-color">{{item.distanceFormat}}km</text> |
            <text class="shop__reach-time primary-color">{{item.reach_time}}分钟</text>
          </view>
        </view>
        <view wx:if="{{item.promotion.length > 0}}" class="shop__promotion">
          <view wx:for="{{item.promotion}}" wx:key="index" class="shop__promotion-item">
            <image class="shop__promotion-icon" src="{{item.pic_url}}"></image>
            {{item.info}}
          </view>
        </view>
      </view>
    </navigator>
  </view>
</view>
<template is="load-more" data="{{loading: loading, hasMore: hasMore, noMoreLabel: '更多商家接入中, 敬请期待'}}"></template>